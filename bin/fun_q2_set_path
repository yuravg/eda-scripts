#!/usr/bin/env sh

#
# Function to set variable coupled to Quartus:
#   QUARTUS_ROOTDIR_OVERRIDE
#   QUARTUS_ROOTDIR,
#   quartus_bin_dir,
#   nios2_bin_dir.
#
# Input parameter:
#  1 - Quartus version number
#  2 - Path to Quartus directory

# FIXME: set Standard Quartus version after Pro

fun_q2_set_path ()
{
    if [ -n "$1" ]; then
        PATH2QUARTUS_VERSION=${QUARTUS_ROOTDIR_OVERRIDE:0:(${#QUARTUS_ROOTDIR_OVERRIDE} - 8)}
        PATH2QUARTUS=${PATH2QUARTUS_VERSION%/*.*}
        if [ "$2" = "pro" ]; then
            PATH2QUARTUS=${PATH2QUARTUS_VERSION%/*.*}_pro
        else
            PATH2QUARTUS=${PATH2QUARTUS_VERSION%/*.*}
        fi
        _PATH="${PATH2QUARTUS}/$1/quartus"
        if [ -d "$_PATH" ]; then
            export QUARTUS_ROOTDIR_OVERRIDE="${_PATH}"
            export QUARTUS_ROOTDIR="${_PATH}"
            printf "\\e[32m\\e[1mSetup of path successful!\\e[0m\\n"
        else
            printf "\\e[31m\\e[1m"
            echo "  *****************************************************"
            echo "  *  ERROR! can't find required '$1' quartus version"
            echo "  *  (there are not PATH: $_PATH)"
            echo "  *****************************************************"
            printf "\\e[0m"
            # exit 1
        fi
    fi

    # BITS:
    if [ "`uname`" = Linux ]; then
        BITS=bin
    fi
    if [ "$OS" = "Windows_NT" ]; then
        if [ $QUARTUS_64BIT -eq 1 ]
        then
            BITS=bin64
        else
            BITS=bin
        fi
    fi

    quartus_bin_dir="$QUARTUS_ROOTDIR_OVERRIDE/$BITS"
    nios2_bin_dir="$QUARTUS_ROOTDIR_OVERRIDE/../nios2eds/bin"
}
